
<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <title>00011-COACTUPC_cbl</title>
    <!-- Incluindo o Bootstrap CSS a partir de CDN -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <!-- Incluindo o Highlight.js CSS para destaque de código -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/default.min.css">
    <style>
        body {
            padding: 20px;
        }
        img {
            max-width: 100%;
            height: auto;
        }
        /* Estilos personalizados podem ser adicionados aqui */
    </style>
</head>
<body>
    <div class="container">
        <p>Gerado em: 1º de outubro de 2024</p>
<p><strong>Título do Documento:</strong> Especificação do Programa de Atualização de Conta CardDemo</p>
<p><strong>Descrição Resumida:</strong>
O Programa de Atualização de Conta CardDemo é um programa COBOL que permite que usuários autorizados visualizem e atualizem informações de contas de clientes. O programa recupera informações do cliente e da conta de arquivos VSAM com base no número da conta fornecido, exibe as informações para o usuário, permite modificações, valida os dados de entrada e atualiza os arquivos VSAM com as alterações após a confirmação.</p>
<p><strong>Histórias do Usuário:</strong>
Como representante de atendimento ao cliente, preciso visualizar e atualizar as informações da conta do cliente para poder auxiliá-los em suas consultas e solicitações.</p>
<p><strong>Épico Relacionado:</strong> <code>2 - Gestão de Contas</code></p>
<p><strong>Requisitos Técnicos:</strong></p>
<ul>
<li><strong>Inicialização do Programa:</strong>
<ul>
<li>Inicializar variáveis de armazenamento de trabalho e área de comunicação do programa.</li>
<li>Configurar o tratamento de erros.</li>
<li>Armazenar o contexto do programa e os dados passados (se houver).</li>
<li>Remapear as teclas PF e armazenar a tecla mapeada.</li>
</ul>
</li>
<li><strong>Processamento de Entrada:</strong>
<ul>
<li><strong>Receber Entrada do Usuário:</strong> Receber entrada do usuário do mapa <code>COACTUP</code>.</li>
<li><strong>Editar e Validar Entrada:</strong>
<ul>
<li><strong>Número da Conta:</strong> Validar se o número da conta é numérico, tem 11 dígitos e é diferente de zero.</li>
<li><strong>Status Ativo:</strong> Validar se o status é ‘Y’ ou ‘N’.</li>
<li><strong>Limite de Crédito, Limite de Crédito em Dinheiro, Saldo Atual, Crédito do Ciclo Atual, Débito do Ciclo Atual:</strong> Validar se os valores são numéricos e estão no formato correto.</li>
<li><strong>Data de Abertura, Data de Vencimento, Data de Reemissão, Data de Nascimento:</strong> Validar se as datas estão no formato <code>AAAA-MM-DD</code> e são válidas.</li>
<li><strong>SSN:</strong> Validar se o SSN está no formato <code>XXX-XX-XXXX</code> e segue as regras do SSN.</li>
<li><strong>Pontuação FICO:</strong> Validar se a pontuação FICO é numérica e está entre 300 e 850.</li>
<li><strong>Nome (Primeiro, Intermediário, Último):</strong> Validar se os nomes contêm apenas caracteres alfabéticos e espaços.</li>
<li><strong>Endereço Linha 1, Cidade, Estado, País:</strong> Validar se os campos de endereço contêm apenas caracteres alfanuméricos e espaços.</li>
<li><strong>CEP:</strong> Validar se o CEP é numérico e corresponde ao código do estado.</li>
<li><strong>Números de Telefone (1 e 2):</strong> Validar se os números de telefone estão no formato <code>(XXX) XXX-XXXX</code> e se o código de área é válido.</li>
<li><strong>ID da Conta EFT:</strong> Validar se o ID da conta EFT é numérico.</li>
<li><strong>Titular do Cartão Principal:</strong> Validar se o indicador é ‘Y’ ou ‘N’.</li>
</ul>
</li>
</ul>
</li>
<li><strong>Recuperação de Dados:</strong>
<ul>
<li><strong>Obter Referência Cruzada do Cartão por Conta:</strong> Ler o arquivo <code>CARDXREF</code> usando o ID da conta como chave. Se encontrado, extrair o ID do cliente e o número do cartão.</li>
<li><strong>Obter Dados da Conta por Conta:</strong> Ler o arquivo <code>ACCTDAT</code> usando o ID da conta como chave.</li>
<li><strong>Obter Dados do Cliente por Cliente:</strong> Ler o arquivo <code>CUSTDAT</code> usando o ID do cliente como chave.</li>
</ul>
</li>
<li><strong>Comparação de Dados:</strong> Comparar os novos dados inseridos pelo usuário com os dados originais recuperados dos arquivos. Se houver alguma alteração, definir o sinalizador de alteração.</li>
<li><strong>Confirmação de Atualização:</strong> Se forem detectadas alterações, solicitar ao usuário que confirme a atualização.</li>
<li><strong>Atualização de Dados:</strong>
<ul>
<li><strong>Ler Conta para Atualização:</strong> Ler o arquivo <code>ACCTDAT</code> com intenção de atualização.</li>
<li><strong>Ler Cliente para Atualização:</strong> Ler o arquivo <code>CUSTDAT</code> com intenção de atualização.</li>
<li><strong>Verificar Atualizações Concorrentes:</strong> Garantir que os registros não tenham sido alterados por outro usuário desde que foram lidos.</li>
<li><strong>Atualizar Registro da Conta:</strong> Atualizar o arquivo <code>ACCTDAT</code> com as novas informações da conta.</li>
<li><strong>Atualizar Registro do Cliente:</strong> Atualizar o arquivo <code>CUSTDAT</code> com as novas informações do cliente.</li>
</ul>
</li>
<li><strong>Controle de Concorrência:</strong>
<ul>
<li>O programa usa <code>READ with UPDATE</code> para bloquear os registros durante o processo de atualização.</li>
<li>Antes de regravar os registros, o programa compara os dados nos arquivos com os dados que foram lidos originalmente para verificar se algum outro usuário modificou os registros. Se os dados foram alterados, a atualização é abortada e o usuário é informado.</li>
</ul>
</li>
<li><strong>Tratamento de Erros:</strong>
<ul>
<li>O programa usa <code>EXEC CICS HANDLE ABEND</code> para lidar com abends.</li>
<li>As operações de E/S de arquivo usam as opções <code>RESP</code> e <code>RESP2</code> para verificar erros.</li>
<li>As rotinas de validação de entrada definem sinalizadores de erro e mensagens.</li>
<li>As mensagens de erro são exibidas ao usuário na tela.</li>
</ul>
</li>
<li><strong>Segurança de Dados:</strong>
<ul>
<li>O programa assume que a autenticação e autorização do usuário são tratadas por mecanismos de segurança externos.</li>
<li>Nenhuma criptografia de dados explícita é implementada no código.</li>
</ul>
</li>
<li><strong>Manipulação de Tela:</strong>
<ul>
<li>O programa usa os comandos <code>CICS SEND MAP</code> e <code>RECEIVE MAP</code> para interagir com o usuário.</li>
<li>Os mapas <code>BMS</code> são usados para definir os layouts de tela.</li>
<li>Os atributos de campo (protegido, desprotegido, cor) são definidos dinamicamente com base no estado do programa e nos resultados da validação.</li>
<li>A posição do cursor é definida para o primeiro campo com um erro.</li>
</ul>
</li>
</ul>
<p><strong>Modelos Relacionados</strong></p>
<ul>
<li><code>ACCOUNT-RECORD</code>: Representa os dados da conta.
<ul>
<li><code>ACCT-ID</code> <code>Numeric(11,0)</code>: ID da conta.</li>
<li><code>ACCT-ACTIVE-STATUS</code> <code>Alphanumeric(1)</code>: Status da conta (Ativo/Inativo).</li>
<li><code>ACCT-CURR-BAL</code> <code>Numeric(10,2)</code>: Saldo atual da conta.</li>
<li><code>ACCT-CREDIT-LIMIT</code> <code>Numeric(10,2)</code>: Limite de crédito.</li>
<li><code>ACCT-CASH-CREDIT-LIMIT</code> <code>Numeric(10,2)</code>: Limite de crédito em dinheiro.</li>
<li><code>ACCT-OPEN-DATE</code> <code>Alphanumeric(10)</code>: Data de abertura da conta (<code>AAAA-MM-DD</code>).</li>
<li><code>ACCT-EXPIRAION-DATE</code> <code>Alphanumeric(10)</code>: Data de vencimento da conta (<code>AAAA-MM-DD</code>).</li>
<li><code>ACCT-REISSUE-DATE</code> <code>Alphanumeric(10)</code>: Data de reemissão da conta (<code>AAAA-MM-DD</code>).</li>
<li><code>ACCT-CURR-CYC-CREDIT</code> <code>Numeric(10,2)</code>: Crédito do ciclo atual.</li>
<li><code>ACCT-CURR-CYC-DEBIT</code> <code>Numeric(10,2)</code>: Débito do ciclo atual.</li>
<li><code>ACCT-GROUP-ID</code> <code>Alphanumeric(10)</code>: ID do grupo da conta.</li>
</ul>
</li>
<li><code>CUSTOMER-RECORD</code>: Representa os dados do cliente.
<ul>
<li><code>CUST-ID</code> <code>Numeric(9,0)</code>: ID do cliente.</li>
<li><code>CUST-FIRST-NAME</code> <code>Alphanumeric(25)</code>: Primeiro nome do cliente.</li>
<li><code>CUST-MIDDLE-NAME</code> <code>Alphanumeric(25)</code>: Nome do meio do cliente.</li>
<li><code>CUST-LAST-NAME</code> <code>Alphanumeric(25)</code>: Sobrenome do cliente.</li>
<li><code>CUST-ADDR-LINE-1</code> <code>Alphanumeric(50)</code>: Endereço linha 1 do cliente.</li>
<li><code>CUST-ADDR-LINE-2</code> <code>Alphanumeric(50)</code>: Endereço linha 2 do cliente.</li>
<li><code>CUST-ADDR-LINE-3</code> <code>Alphanumeric(50)</code>: Endereço linha 3 do cliente.</li>
<li><code>CUST-ADDR-STATE-CD</code> <code>Alphanumeric(2)</code>: Código do estado do cliente.</li>
<li><code>CUST-ADDR-COUNTRY-CD</code> <code>Alphanumeric(3)</code>: Código do país do cliente.</li>
<li><code>CUST-ADDR-ZIP</code> <code>Alphanumeric(10)</code>: CEP do cliente.</li>
<li><code>CUST-PHONE-NUM-1</code> <code>Alphanumeric(15)</code>: Número de telefone 1 do cliente.</li>
<li><code>CUST-PHONE-NUM-2</code> <code>Alphanumeric(15)</code>: Número de telefone 2 do cliente.</li>
<li><code>CUST-SSN</code> <code>Numeric(9,0)</code>: Número do Seguro Social do cliente.</li>
<li><code>CUST-GOVT-ISSUED-ID</code> <code>Alphanumeric(20)</code>: ID emitido pelo governo do cliente.</li>
<li><code>CUST-DOB-YYYY-MM-DD</code> <code>Alphanumeric(10)</code>: Data de nascimento do cliente (<code>AAAA-MM-DD</code>).</li>
<li><code>CUST-EFT-ACCOUNT-ID</code> <code>Alphanumeric(10)</code>: ID da conta EFT do cliente.</li>
<li><code>CUST-PRI-CARD-HOLDER-IND</code> <code>Alphanumeric(1)</code>: Indicador do titular do cartão principal.</li>
<li><code>CUST-FICO-CREDIT-SCORE</code> <code>Numeric(3,0)</code>: Pontuação de crédito FICO do cliente.</li>
</ul>
</li>
<li><code>CARD-XREF-RECORD</code>: Representa os dados de referência cruzada do cartão.
<ul>
<li><code>XREF-CARD-NUM</code> <code>Alphanumeric(16)</code>: Número do cartão.</li>
<li><code>XREF-CUST-ID</code> <code>Numeric(9,0)</code>: ID do cliente.</li>
<li><code>XREF-ACCT-ID</code> <code>Numeric(11,0)</code>: ID da conta.</li>
</ul>
</li>
</ul>
<p><strong>Configurações:</strong></p>
<ul>
<li><code>LIT-ACCTFILENAME</code>: <code>ACCTDAT</code> - Nome do arquivo para o arquivo Mestre da Conta.</li>
<li><code>LIT-CUSTFILENAME</code>: <code>CUSTDAT</code> - Nome do arquivo para o arquivo Mestre do Cliente.</li>
<li><code>LIT-CARDXREFNAME-ACCT-PATH</code>: <code>CXACAIX</code> - Nome do arquivo para o arquivo de Referência Cruzada do Cartão, acessado por meio de um índice alternativo com base no ID da conta.</li>
</ul>
<p><strong>Melhorias de Código:</strong></p>
<ul>
<li><strong>Tratamento de Erros:</strong> Implementar um mecanismo de tratamento de erros mais centralizado e consistente. Usar uma estrutura de mensagem de erro comum e uma rotina dedicada de registro de erros.</li>
<li><strong>Modularidade:</strong> Dividir os parágrafos longos em métodos menores e mais gerenciáveis.</li>
<li><strong>Estruturas de Dados:</strong> Usar nomes de estrutura de dados mais descritivos.</li>
<li><strong>Comentários:</strong> Adicionar mais comentários para explicar a lógica e as regras de negócios.</li>
<li><strong>Constantes:</strong> Definir constantes para nomes de arquivo, IDs de transação e outros literais.</li>
<li><strong>Validação de Data:</strong> Usar uma rotina de validação de data em vez de verificações manuais.</li>
<li><strong>Formatação de Código:</strong> Melhorar a formatação do código para melhor legibilidade.</li>
</ul>
<p><strong>Melhorias de Segurança:</strong></p>
<ul>
<li><strong>Autenticação e Autorização:</strong> Implementar mecanismos adequados de autenticação e autorização para garantir que apenas usuários autorizados possam acessar e modificar as informações da conta.</li>
<li><strong>Criptografia de Dados:</strong> Criptografar dados confidenciais, como SSN e informações financeiras, tanto em armazenamento quanto em trânsito.</li>
<li><strong>Trilha de Auditoria:</strong> Registrar todas as ações do usuário, incluindo modificações de dados, para fins de auditoria.</li>
</ul>
<p><strong>Diagrama Conceitual:</strong></p>
<img src="00011-COACTUPC_cbl_diagram_1.svg" alt="Mermaid Diagram 1" style="max-width: 100%; height: auto;"><p>–Made by “Smart Engineering” (by Compass.UOL)–</p>

    </div>
    <!-- Incluindo o jQuery e o Bootstrap JS a partir de CDN -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.2/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Incluindo o Highlight.js JS para destaque de código -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
    <script>hljs.highlightAll();</script>
</body>
</html>
