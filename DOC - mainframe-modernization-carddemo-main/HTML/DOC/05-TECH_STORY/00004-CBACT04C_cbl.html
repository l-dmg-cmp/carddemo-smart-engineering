
<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <title>00004-CBACT04C_cbl</title>
    <!-- Incluindo o Bootstrap CSS a partir de CDN -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <!-- Incluindo o Highlight.js CSS para destaque de código -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/default.min.css">
    <style>
        body {
            padding: 20px;
        }
        img {
            max-width: 100%;
            height: auto;
        }
        /* Estilos personalizados podem ser adicionados aqui */
    </style>
</head>
<body>
    <div class="container">
        <p>Gerado em: 1º de outubro de 2024</p>
<p><strong>Título do Documento:</strong> CardDemo Cálculo de Juros - Especificação de Processamento em Lote</p>
<p><strong>Descrição Resumida:</strong>
O programa CardDemo Cálculo de Juros é um processo em lote que calcula e aplica juros mensais às contas de cartão de crédito dos clientes. O cálculo é baseado no grupo da conta do cliente, categoria da transação e taxas de juros predefinidas. O programa lê os detalhes da transação do <code>TCATBAL-FILE</code> (Arquivo de Saldo da Categoria de Transação), recupera as informações da conta do <code>ACCOUNT-FILE</code> (Arquivo Mestre da Conta) e obtém as taxas de juros do <code>DISCGRP-FILE</code> (Arquivo do Grupo de Divulgação). Para cada categoria de transação, o programa calcula os juros mensais e atualiza o saldo da conta do cliente de acordo. Ele também gera registros de transação para cada aplicação de juros, que são gravados no <code>TRANSACT-FILE</code> (Arquivo de Transação).</p>
<p><strong>Histórias do Usuário:</strong>
Como analista de operações financeiras, preciso de um sistema que calcule e aplique automaticamente juros mensais às contas de cartão de crédito dos clientes para garantir uma cobrança precisa e geração de receita.</p>
<p><strong>Épico Relacionado:</strong> 4 - Processamento de Transações</p>
<p><strong>Requisitos Técnicos:</strong></p>
<ol>
<li><strong>Ler Dados de Saldo da Categoria de Transação:</strong> Ler cada registro do <code>TCATBAL-FILE</code> sequencialmente.
<ul>
<li>Entrada: <code>TCATBAL-FILE</code> contendo <code>FD-TRAN-CAT-BAL-RECORD</code>.</li>
<li>Processamento: Para cada registro, extraia <code>FD-TRANCAT-ACCT-ID</code>, <code>FD-TRANCAT-TYPE-CD</code> e <code>FD-TRANCAT-CD</code>.</li>
<li>Saída: Dados extraídos para processamento subsequente.</li>
</ul>
</li>
<li><strong>Recuperar Dados da Conta:</strong> Para cada <code>FD-TRANCAT-ACCT-ID</code> exclusivo, recupere os detalhes da conta do <code>ACCOUNT-FILE</code>.
<ul>
<li>Entrada: <code>FD-TRANCAT-ACCT-ID</code> dos dados de saldo da categoria de transação.</li>
<li>Processamento:
<ul>
<li>Leia o <code>ACCOUNT-FILE</code> usando <code>FD-TRANCAT-ACCT-ID</code> como chave.</li>
<li>Extraia <code>ACCT-GROUP-ID</code> e <code>ACCT-CURR-BAL</code> do <code>ACCOUNT-RECORD</code> recuperado.</li>
</ul>
</li>
<li>Saída: <code>ACCT-GROUP-ID</code>, <code>ACCT-CURR-BAL</code> e outros dados relevantes da conta.</li>
</ul>
</li>
<li><strong>Recuperar Taxa de Juros:</strong> Com base em <code>ACCT-GROUP-ID</code>, <code>FD-TRANCAT-TYPE-CD</code> e <code>FD-TRANCAT-CD</code>, busque a taxa de juros aplicável no <code>DISCGRP-FILE</code>.
<ul>
<li>Entrada: <code>ACCT-GROUP-ID</code>, <code>FD-TRANCAT-TYPE-CD</code> e <code>FD-TRANCAT-CD</code> das etapas anteriores.</li>
<li>Processamento:
<ul>
<li>Leia o <code>DISCGRP-FILE</code> usando a combinação de <code>ACCT-GROUP-ID</code>, <code>FD-TRANCAT-TYPE-CD</code> e <code>FD-TRANCAT-CD</code> como chave.</li>
<li>Se um registro for encontrado, extraia <code>DIS-INT-RATE</code>.</li>
<li>Se nenhum registro for encontrado (código de status <code>23</code>), tente novamente usando <code>'DEFAULT'</code> como o <code>ACCT-GROUP-ID</code>.</li>
<li>Se ainda não for encontrado, trate como uma condição de erro (taxa de juros ausente).</li>
</ul>
</li>
<li>Saída: <code>DIS-INT-RATE</code> (taxa de juros).</li>
</ul>
</li>
<li><strong>Calcular Juros Mensais:</strong> Calcule os juros mensais para a categoria de transação usando a fórmula:
<ul>
<li><code>Juros Mensais = (Saldo da Categoria de Transação * Taxa de Juros) / (12 * 100)</code></li>
<li>Entrada: <code>TRAN-CAT-BAL</code> (de <code>FD-TRAN-CAT-BAL-RECORD</code>) e <code>DIS-INT-RATE</code>.</li>
<li>Processamento: Aplique a fórmula de cálculo de juros.</li>
<li>Saída: <code>WS-MONTHLY-INT</code> (juros mensais calculados).</li>
</ul>
</li>
<li><strong>Atualizar Saldo da Conta:</strong> Atualize o saldo da conta do cliente no <code>ACCOUNT-FILE</code> adicionando os juros mensais calculados.
<ul>
<li>Entrada: <code>WS-MONTHLY-INT</code> e <code>ACCT-CURR-BAL</code>.</li>
<li>Processamento:
<ul>
<li>Adicione <code>WS-MONTHLY-INT</code> a <code>ACCT-CURR-BAL</code>.</li>
<li>Redefina <code>ACCT-CURR-CYC-CREDIT</code> e <code>ACCT-CURR-CYC-DEBIT</code> para zero.</li>
<li>Atualize o <code>ACCOUNT-RECORD</code> correspondente no <code>ACCOUNT-FILE</code>.</li>
</ul>
</li>
<li>Saída: <code>ACCOUNT-FILE</code> atualizado com o novo saldo.</li>
</ul>
</li>
<li><strong>Gerar Registro de Transação:</strong> Gere um registro de transação para os juros aplicados e grave-o no <code>TRANSACT-FILE</code>.
<ul>
<li>Entrada: <code>TRAN-ID</code>, <code>TRAN-TYPE-CD</code>, <code>TRAN-CAT-CD</code>, <code>TRAN-SOURCE</code>, <code>TRAN-DESC</code>, <code>TRAN-AMT</code>, <code>TRAN-CARD-NUM</code>, <code>TRAN-ORIG-TS</code> e <code>TRAN-PROC-TS</code>.</li>
<li>Processamento:
<ul>
<li>Preencha os campos do registro de transação.</li>
<li>Gere um <code>TRAN-ID</code> exclusivo.</li>
<li>Defina <code>TRAN-TYPE-CD</code> como <code>'01'</code> (juros), <code>TRAN-CAT-CD</code> como <code>'05'</code> (juros) e <code>TRAN-SOURCE</code> como <code>'Sistema'</code>.</li>
<li>Defina <code>TRAN-DESC</code> como <code>'Int. para a/c '</code> concatenado com o <code>ACCT-ID</code>.</li>
<li>Defina <code>TRAN-AMT</code> como o <code>WS-MONTHLY-INT</code> calculado.</li>
<li>Recupere <code>TRAN-CARD-NUM</code> do <code>CARD-XREF-RECORD</code>.</li>
<li>Gere timestamps para <code>TRAN-ORIG-TS</code> e <code>TRAN-PROC-TS</code>.</li>
<li>Grave o <code>TRAN-RECORD</code> no <code>TRANSACT-FILE</code>.</li>
</ul>
</li>
<li>Saída: <code>TRANSACT-FILE</code> com o novo registro de transação de juros.</li>
</ul>
</li>
</ol>
<p><strong>Modelos Relacionados:</strong></p>
<ul>
<li><strong><code>FD-TRAN-CAT-BAL-RECORD</code></strong>: Representa um registro no Arquivo de Saldo da Categoria de Transação (<code>TCATBAL-FILE</code>).
<ul>
<li><code>FD-TRANCAT-ACCT-ID</code> (Numérico(11)): Identificador da Conta.</li>
<li><code>FD-TRANCAT-TYPE-CD</code> (Alfanumérico(2)): Código do Tipo de Transação.</li>
<li><code>FD-TRANCAT-CD</code> (Numérico(4)): Código da Transação.</li>
<li><code>FD-FD-TRAN-CAT-DATA</code> (Alfanumérico(33)): Dados adicionais do saldo da categoria de transação.</li>
</ul>
</li>
<li><strong><code>ACCOUNT-RECORD</code></strong>: Representa um registro de conta do cliente no Arquivo Mestre da Conta (<code>ACCOUNT-FILE</code>).
<ul>
<li><code>FD-ACCT-ID</code> (Numérico(11)): Identificador da Conta.</li>
<li><code>FD-ACCT-DATA</code> (Alfanumérico(289)): Outros dados relacionados à conta, incluindo saldo, ID do grupo, etc.</li>
</ul>
</li>
<li><strong><code>DIS-GROUP-RECORD</code></strong>: Representa um registro no Arquivo do Grupo de Divulgação (<code>DISCGRP-FILE</code>).
<ul>
<li><code>FD-DIS-ACCT-GROUP-ID</code> (Alfanumérico(10)): Identificador do Grupo da Conta.</li>
<li><code>FD-DIS-TRAN-TYPE-CD</code> (Alfanumérico(2)): Código do Tipo de Transação.</li>
<li><code>FD-DIS-TRAN-CAT-CD</code> (Numérico(4)): Código da Transação.</li>
<li><code>FD-DISCGRP-DATA</code> (Alfanumérico(34)): Dados adicionais do grupo de divulgação.</li>
</ul>
</li>
<li><strong><code>TRAN-RECORD</code></strong>: Representa um registro de transação no Arquivo de Transação (<code>TRANSACT-FILE</code>).
<ul>
<li><code>FD-TRANS-ID</code> (Alfanumérico(16)): Identificador da Transação.</li>
<li><code>FD-ACCT-DATA</code> (Alfanumérico(334)): Dados relacionados à transação.</li>
</ul>
</li>
</ul>
<p><strong>Configurações:</strong></p>
<ul>
<li>Caminhos de Arquivo:
<ul>
<li><code>TCATBAL-FILE</code>: Caminho para o Arquivo de Saldo da Categoria de Transação.</li>
<li><code>XREF-FILE</code>: Caminho para o Arquivo de Referência Cruzada.</li>
<li><code>ACCOUNT-FILE</code>: Caminho para o Arquivo Mestre da Conta.</li>
<li><code>DISCGRP-FILE</code>: Caminho para o Arquivo do Grupo de Divulgação.</li>
<li><code>TRANSACT-FILE</code>: Caminho para o Arquivo de Transação.</li>
</ul>
</li>
<li>Grupo de Taxa de Juros Padrão: <code>'DEFAULT'</code></li>
<li>Código do Tipo de Transação para Juros: <code>'01'</code></li>
<li>Código da Categoria de Transação para Juros: <code>'05'</code></li>
<li>Fonte da Transação para Juros: <code>'Sistema'</code></li>
</ul>
<p><strong>Melhorias de Código:</strong></p>
<ul>
<li><strong>Tratamento de Erros:</strong> Implemente um tratamento de erros mais abrangente, incluindo erros de registro em um arquivo separado e/ou envio de notificações aos administradores do sistema.</li>
<li><strong>Registro em Log:</strong> Aprimore o registro em log para incluir timestamps, códigos de erro específicos e valores de dados relevantes para facilitar a depuração e solução de problemas.</li>
<li><strong>Modularidade:</strong> Divida o programa em sub-rotinas ou funções menores e mais gerenciáveis para melhorar a legibilidade e a manutenção do código.</li>
<li><strong>Otimização de Desempenho:</strong> Explore técnicas de otimização de desempenho, como o uso de pesquisa binária para recuperação mais rápida de registros de arquivos indexados, especialmente ao lidar com conjuntos de dados grandes.</li>
<li><strong>Documentação:</strong> Adicione mais comentários in-line para explicar a lógica e o propósito de diferentes seções de código.</li>
</ul>
<p><strong>Melhorias de Segurança:</strong></p>
<ul>
<li><strong>Controle de Acesso:</strong> Implemente medidas rígidas de controle de acesso para restringir o acesso não autorizado a arquivos de dados confidenciais e ao próprio programa.</li>
<li><strong>Criptografia de Dados:</strong> Considere criptografar dados confidenciais em repouso e em trânsito para proteger contra acesso não autorizado e violações de dados.</li>
<li><strong>Auditoria:</strong> Implemente trilhas de auditoria para rastrear todo acesso a dados, modificações e execuções de programas para fins de segurança e conformidade.</li>
</ul>
<p><strong>Diagrama Conceitual:</strong></p>
<img src="00004-CBACT04C_cbl_diagram_1.svg" alt="Mermaid Diagram 1" style="max-width: 100%; height: auto;"><p>–Made by “Smart Engineering” (by Compass.UOL)–</p>

    </div>
    <!-- Incluindo o jQuery e o Bootstrap JS a partir de CDN -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.2/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Incluindo o Highlight.js JS para destaque de código -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
    <script>hljs.highlightAll();</script>
</body>
</html>
