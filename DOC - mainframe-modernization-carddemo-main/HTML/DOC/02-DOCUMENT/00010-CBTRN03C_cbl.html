
<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <title>00010-CBTRN03C_cbl</title>
    <!-- Incluindo o Bootstrap CSS a partir de CDN -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <!-- Incluindo o Highlight.js CSS para destaque de código -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/default.min.css">
    <style>
        body {
            padding: 20px;
        }
        img {
            max-width: 100%;
            height: auto;
        }
        /* Estilos personalizados podem ser adicionados aqui */
    </style>
</head>
<body>
    <div class="container">
        <p>Gerado em: 1º de outubro de 2024</p>
<h1>CardDemo Relatório de Detalhes de Transações de Cartão de Crédito</h1>
<h2>Título</h2>
<ul>
<li>Título do Documento: CardDemo Relatório de Detalhes de Transações de Cartão de Crédito - Especificação do Programa</li>
</ul>
<h2>Arquivo</h2>
<ul>
<li>Arquivo: \src\CBTRN03C.cbl</li>
</ul>
<h2>Descrição Resumida</h2>
<p>Este documento descreve as especificações para o programa CBTRN03C dentro do aplicativo CardDemo. Este programa COBOL em lote gera um relatório detalhado das transações de cartão de crédito, resumindo informações importantes para um período específico.</p>
<h2>Histórico de Versões</h2>
<ul>
<li>Versão 1.0: Versão inicial - CardDemo_v1.0-15-g27d6c6f-68 (19 de julho de 2022)</li>
</ul>
<h2>Descrição do Processo</h2>
<p>O programa CBTRN03C lê dados de transações de cartão de crédito de um arquivo sequencial (TRANSACT-FILE), recupera informações relacionadas de arquivos indexados (XREF-FILE, TRANTYPE-FILE, TRANCATG-FILE) e gera um relatório formatado (REPORT-FILE) resumindo as transações.</p>
<p>Aqui está uma análise simplificada do processo:</p>
<ol>
<li><strong>Inicialização:</strong> O programa abre todos os arquivos necessários (dados de transação, dados de referência cruzada para contas, tipos de transação, categorias de transação, saída do relatório e parâmetros de data).</li>
<li><strong>Entrada do Intervalo de Datas:</strong> Ele lê as datas de início e término do relatório de um arquivo separado (DATE-PARMS-FILE).</li>
<li><strong>Processamento de Transações:</strong> O programa lê cada registro de transação e executa o seguinte:
<ul>
<li><strong>Recuperação de Dados:</strong> Busca informações adicionais sobre a transação, como detalhes da conta, descrição do tipo de transação e descrição da categoria dos respectivos arquivos indexados.</li>
<li><strong>Agregação de Dados:</strong> Calcula totais de página, totais de conta e um total geral para as transações processadas.</li>
<li><strong>Formatação do Relatório:</strong>  Formata as informações recuperadas em um relatório estruturado, incluindo cabeçalhos, detalhes da transação e totais resumidos.</li>
</ul>
</li>
<li><strong>Geração do Relatório:</strong> O programa grava o relatório formatado em um arquivo de saída (REPORT-FILE).</li>
<li><strong>Término:</strong> O programa fecha todos os arquivos abertos e termina.</li>
</ol>
<h2>Requisitos para Iniciar o Processo</h2>
<ol>
<li>
<p><strong>Arquivos de Entrada:</strong></p>
<ul>
<li><strong>TRANSACT-FILE:</strong> Contém registros de transações de cartão de crédito.</li>
<li><strong>XREF-FILE:</strong>  Contém dados de referência cruzada vinculando números de cartão a IDs de conta.</li>
<li><strong>TRANTYPE-FILE:</strong> Contém descrições para diferentes tipos de transação.</li>
<li><strong>TRANCATG-FILE:</strong> Contém descrições para diferentes categorias de transação.</li>
<li><strong>DATE-PARMS-FILE:</strong> Contém as datas de início e término do período do relatório.</li>
</ul>
</li>
<li>
<p><strong>Arquivo de Saída:</strong></p>
<ul>
<li><strong>REPORT-FILE:</strong> O programa irá gerar um arquivo de relatório contendo as informações detalhadas da transação.</li>
</ul>
</li>
</ol>
<h2>Validações e Regras</h2>
<ul>
<li><strong>Validação do Intervalo de Datas:</strong> O programa deve validar as datas de início e término lidas do DATE-PARMS-FILE para garantir que sejam datas válidas e que a data de início não seja posterior à data de término.</li>
<li><strong>Verificações de Status do Arquivo:</strong>  O programa realiza verificações no status das operações do arquivo (abrir, ler, gravar, fechar) e trata de quaisquer erros encontrados.</li>
<li><strong>Validação de Dados:</strong> Embora não seja descrito explicitamente, o programa deve idealmente incluir verificações de validação de dados nos dados da transação para garantir sua precisão e consistência. Por exemplo:
<ul>
<li>Validar valores de transação para garantir que sejam numéricos.</li>
<li>Verificar os tipos e categorias de transação em relação aos dados nos respectivos arquivos.</li>
<li>Verificar se há algum elemento de dados inválido ou ausente nos registros de transação.</li>
</ul>
</li>
</ul>
<h2>Detalhes Técnicos</h2>
<p><strong>Seções Principais:</strong></p>
<ul>
<li><strong>IDENTIFICATION DIVISION:</strong> Identifica o programa e seu autor.</li>
<li><strong>ENVIRONMENT DIVISION:</strong> Define os arquivos usados pelo programa.</li>
<li><strong>DATA DIVISION:</strong>  Descreve a estrutura dos dados de entrada e saída.</li>
<li><strong>PROCEDURE DIVISION:</strong> Contém a lógica do programa.</li>
</ul>
<p><strong>Estruturas de Dados Principais:</strong></p>
<ul>
<li><strong>TRAN-RECORD:</strong>  Estrutura que contém um único registro de transação lido do TRANSACT-FILE.</li>
<li><strong>CARD-XREF-RECORD:</strong> Estrutura que contém dados de referência cruzada lidos do XREF-FILE.</li>
<li><strong>TRAN-TYPE-RECORD:</strong>  Estrutura que contém a descrição do tipo de transação lida do TRANTYPE-FILE.</li>
<li><strong>TRAN-CAT-RECORD:</strong>  Estrutura que contém a descrição da categoria da transação lida do TRANCATG-FILE.</li>
<li><strong>REPORT-</strong>*:  Várias estruturas usadas para formatar e gravar dados no arquivo de relatório.</li>
</ul>
<p><strong>Funções/Parágrafos Principais:</strong></p>
<ul>
<li><strong>0000-TRANFILE-OPEN:</strong> Abre o TRANSACT-FILE para leitura.</li>
<li><strong>0100-REPTFILE-OPEN:</strong> Abre o REPORT-FILE para gravação.</li>
<li><strong>0200-CARDXREF-OPEN:</strong> Abre o XREF-FILE para leitura.</li>
<li><strong>0300-TRANTYPE-OPEN:</strong> Abre o TRANTYPE-FILE para leitura.</li>
<li><strong>0400-TRANCATG-OPEN:</strong> Abre o TRANCATG-FILE para leitura.</li>
<li><strong>0500-DATEPARM-OPEN:</strong> Abre o DATE-PARMS-FILE para leitura.</li>
<li><strong>0550-DATEPARM-READ:</strong> Lê as datas de início e término do DATE-PARMS-FILE.</li>
<li><strong>1000-TRANFILE-GET-NEXT:</strong> Lê o próximo registro de transação do TRANSACT-FILE.</li>
<li><strong>1100-WRITE-TRANSACTION-REPORT:</strong>  Formata e grava os detalhes da transação no arquivo de relatório.</li>
<li><strong>1110-WRITE-PAGE-TOTALS:</strong> Grava os totais da página no arquivo de relatório.</li>
<li><strong>1120-WRITE-ACCOUNT-TOTALS:</strong> Grava os totais da conta no arquivo de relatório.</li>
<li><strong>1110-WRITE-GRAND-TOTALS:</strong>  Grava o total geral no arquivo de relatório.</li>
<li><strong>1120-WRITE-HEADERS:</strong> Grava os cabeçalhos do relatório no arquivo de relatório.</li>
<li><strong>1111-WRITE-REPORT-REC:</strong>  Grava um registro formatado no arquivo de relatório.</li>
<li><strong>1120-WRITE-DETAIL:</strong> Formata e grava uma única linha de detalhe da transação no relatório.</li>
<li><strong>1500-A-LOOKUP-XREF:</strong>  Recupera o ID da conta do XREF-FILE com base no número do cartão.</li>
<li><strong>1500-B-LOOKUP-TRANTYPE:</strong> Recupera a descrição do tipo de transação do TRANTYPE-FILE.</li>
<li><strong>1500-C-LOOKUP-TRANCATG:</strong> Recupera a descrição da categoria da transação do TRANCATG-FILE.</li>
<li><strong>9000-TRANFILE-CLOSE:</strong> Fecha o TRANSACT-FILE.</li>
<li><strong>9100-REPTFILE-CLOSE:</strong> Fecha o REPORT-FILE.</li>
<li><strong>9200-CARDXREF-CLOSE:</strong> Fecha o XREF-FILE.</li>
<li><strong>9300-TRANTYPE-CLOSE:</strong> Fecha o TRANTYPE-FILE.</li>
<li><strong>9400-TRANCATG-CLOSE:</strong> Fecha o TRANCATG-FILE.</li>
<li><strong>9500-DATEPARM-CLOSE:</strong> Fecha o DATE-PARMS-FILE.</li>
<li><strong>9999-ABEND-PROGRAM:</strong>  Interrompe o programa em caso de erro fatal.</li>
<li><strong>9910-DISPLAY-IO-STATUS:</strong>  Exibe o status do arquivo em caso de erro de E/S.</li>
</ul>
<p><strong>Variáveis:</strong></p>
<ul>
<li><strong>WS-START-DATE:</strong> Armazena a data de início do período do relatório.</li>
<li><strong>WS-END-DATE:</strong> Armazena a data de término do período do relatório.</li>
<li><strong>WS-PAGE-TOTAL:</strong>  Accumula o valor total da transação para a página atual.</li>
<li><strong>WS-ACCOUNT-TOTAL:</strong>  Acumula o valor total da transação para a conta atual.</li>
<li><strong>WS-GRAND-TOTAL:</strong> Acumula o total geral de todos os valores de transação.</li>
<li><strong>TRANFILE-STATUS, CARDXREF-STATUS, TRANTYPE-STATUS, TRANCATG-STATUS, REPTFILE-STATUS, DATEPARM-STATUS:</strong>  Variáveis para armazenar o status do arquivo após cada operação de E/S.</li>
</ul>
<h2>Segurança</h2>
<ul>
<li><strong>Não Aplicável:</strong> O trecho de código fornecido não contém nenhuma implementação de segurança explícita.</li>
</ul>
<p><strong>Considerações de Segurança:</strong></p>
<ul>
<li><strong>Controle de Acesso:</strong>  Implemente mecanismos de controle de acesso para restringir o acesso não autorizado ao programa, arquivos de entrada e relatórios de saída. Isso pode envolver autenticação de usuário e autorização com base em funções e permissões predefinidas.</li>
<li><strong>Criptografia de Dados:</strong>  Considere criptografar dados confidenciais nos arquivos de transação, especialmente se eles contiverem informações de identificação pessoal (PII) ou detalhes financeiros, para proteger contra acesso não autorizado.</li>
<li><strong>Registro de Auditoria:</strong> Implemente o registro de auditoria para rastrear a execução do programa, acesso do usuário e quaisquer modificações feitas nos dados. Isso ajuda a identificar e investigar quaisquer violações de segurança ou atividades suspeitas.</li>
</ul>
<h2>Impacto em Outros Sistemas</h2>
<ul>
<li><strong>Dependências de Dados:</strong> O programa depende da disponibilidade oportuna e precisa de dados dos arquivos de entrada (dados de transação, dados de referência cruzada, tipos de transação, categorias de transação e parâmetros de data). Quaisquer problemas ou atrasos nesses sistemas de origem impactarão diretamente o processo de geração do relatório.</li>
<li><strong>Sistemas a Jusante:</strong> O relatório de detalhes da transação gerado pode ser usado como entrada para outros sistemas a jusante, como:
<ul>
<li><strong>Sistemas de Reconciliação:</strong>  Para reconciliar transações com extratos bancários e outros registros financeiros.</li>
<li><strong>Sistemas de Detecção de Fraude:</strong> Para identificar transações potencialmente fraudulentas com base em padrões e anomalias nos dados.</li>
<li><strong>Sistemas de Business Intelligence:</strong> Para analisar tendências de transações, comportamento do cliente e outros insights de negócios.</li>
</ul>
</li>
</ul>
<h2>Modelos</h2>
<table>
<thead>
<tr>
<th>Nome do Campo</th>
<th>Tipo</th>
<th>Descrição</th>
</tr>
</thead>
<tbody>
<tr>
<td>FD-TRANFILE-REC</td>
<td>Registro</td>
<td>Representa um registro no TRANSACT-FILE.</td>
</tr>
<tr>
<td>FD-TRANS-DATA</td>
<td>Alfanumérico</td>
<td>Contém os dados reais da transação (detalhes não especificados no código).</td>
</tr>
<tr>
<td>FD-TRAN-PROC-TS</td>
<td>Alfanumérico</td>
<td>Contém o registro de data e hora de quando a transação foi processada.</td>
</tr>
<tr>
<td>FD-CARDXREF-REC</td>
<td>Registro</td>
<td>Representa um registro no XREF-FILE.</td>
</tr>
<tr>
<td>FD-XREF-CARD-NUM</td>
<td>Alfanumérico</td>
<td>Contém o número do cartão de crédito.</td>
</tr>
<tr>
<td>FD-XREF-DATA</td>
<td>Alfanumérico</td>
<td>Contém dados adicionais de referência cruzada (detalhes não especificados).</td>
</tr>
<tr>
<td>FD-TRANTYPE-REC</td>
<td>Registro</td>
<td>Representa um registro no TRANTYPE-FILE.</td>
</tr>
<tr>
<td>FD-TRAN-TYPE</td>
<td>Alfanumérico</td>
<td>Contém o código do tipo de transação.</td>
</tr>
<tr>
<td>FD-TRAN-DATA</td>
<td>Alfanumérico</td>
<td>Contém a descrição do tipo de transação.</td>
</tr>
<tr>
<td>FD-TRAN-CAT-RECORD</td>
<td>Registro</td>
<td>Representa um registro no TRANCATG-FILE.</td>
</tr>
<tr>
<td>FD-TRAN-CAT-KEY</td>
<td>Grupo</td>
<td>Uma chave composta consistindo no código do tipo de transação (FD-TRAN-TYPE-CD) e código da categoria (FD-TRAN-CAT-CD).</td>
</tr>
<tr>
<td>FD-TRAN-CAT-DATA</td>
<td>Alfanumérico</td>
<td>Contém a descrição da categoria da transação.</td>
</tr>
<tr>
<td>FD-REPTFILE-REC</td>
<td>Alfanumérico</td>
<td>Representa uma linha no REPORT-FILE.</td>
</tr>
<tr>
<td>FD-DATEPARM-REC</td>
<td>Alfanumérico</td>
<td>Representa um registro no DATE-PARMS-FILE (detalhes não especificados).</td>
</tr>
</tbody>
</table>
<h2>Principais Referências</h2>
<ul>
<li><strong>VSAM (Virtual Storage Access Method):</strong>  O sistema de arquivos usado para armazenar e acessar os arquivos de dados.</li>
<li><strong>COBOL (Common Business-Oriented Language):</strong>  A linguagem de programação usada para escrever o programa.</li>
<li><strong>JCL (Job Control Language):</strong> Usado para definir e gerenciar trabalhos em lote no sistema mainframe.</li>
<li><strong>Copybooks:</strong>  Módulos de código reutilizáveis (por exemplo, CVTRA05Y, CVACT03Y) contendo estruturas de dados e rotinas comuns.</li>
</ul>
<p>–Made by “Smart Engineering” (by Compass.UOL)–</p>

    </div>
    <!-- Incluindo o jQuery e o Bootstrap JS a partir de CDN -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.2/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Incluindo o Highlight.js JS para destaque de código -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
    <script>hljs.highlightAll();</script>
</body>
</html>
