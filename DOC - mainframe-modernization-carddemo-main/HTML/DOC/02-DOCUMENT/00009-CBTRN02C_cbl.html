
<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <title>00009-CBTRN02C_cbl</title>
    <!-- Incluindo o Bootstrap CSS a partir de CDN -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <!-- Incluindo o Highlight.js CSS para destaque de código -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/default.min.css">
    <style>
        body {
            padding: 20px;
        }
        img {
            max-width: 100%;
            height: auto;
        }
        /* Estilos personalizados podem ser adicionados aqui */
    </style>
</head>
<body>
    <div class="container">
        <p>Gerado em: 1º de outubro de 2024</p>
<h1><strong>Processamento Diário de Transações CardDemo</strong></h1>
<h2>Título</h2>
<ul>
<li>Título do Documento: CardDemo - Especificação do Processador de Transações Diárias</li>
</ul>
<h2>Arquivo</h2>
<ul>
<li>Rota do Arquivo: \src\CBTRN02C.cbl</li>
</ul>
<h2>Descrição Resumida</h2>
<p>Este documento descreve as especificações para o Processador de Transações Diárias CardDemo, um programa COBOL em lote crucial para o aplicativo CardDemo. Este programa forma o núcleo do sistema diário de processamento de cartão de crédito. Sua principal função é processar transações diárias de cartão de crédito, aplicando-as às contas dos clientes, ao mesmo tempo em que segue regras de negócios predefinidas. Este documento visa fornecer uma compreensão clara da funcionalidade, requisitos e detalhes técnicos do programa para stakeholders técnicos e não técnicos.</p>
<h2>Histórico da Versão</h2>
<ul>
<li>CardDemo_v1.0-15-g27d6c6f-68: 19 de julho de 2022 - Versão inicial</li>
</ul>
<h2>Descrição do Processo</h2>
<ol>
<li><strong>Inicialização (Abrir Arquivos):</strong> O programa começa abrindo todos os arquivos necessários:
<ul>
<li>Arquivo de Transações Diárias (entrada): Contém uma lista de transações diárias de cartão de crédito.</li>
<li>Arquivo de Transações (saída): Armazena as transações processadas com sucesso.</li>
<li>Arquivo de Referência Cruzada (entrada): Mapeia números de cartão de crédito para IDs de conta.</li>
<li>Arquivo de Rejeições Diárias (saída): Registra transações rejeitadas com os motivos.</li>
<li>Arquivo de Conta (entrada/saída): Contém informações da conta do cliente.</li>
<li>Arquivo de Saldo de Categoria de Transação (entrada/saída): Rastreia saldos para diferentes categorias de transação.</li>
</ul>
</li>
<li><strong>Processar Transações Diárias:</strong>
<ul>
<li>O programa lê cada transação do Arquivo de Transações Diárias.</li>
<li>Para cada transação, ele executa o seguinte:
<ul>
<li><strong>Validação:</strong>
<ul>
<li>Verifica se o número do cartão de crédito é válido consultando o Arquivo de Referência Cruzada.</li>
<li>Verifica se existe uma conta correspondente usando o Arquivo de Conta.</li>
<li>Garante que a transação não exceda o limite de crédito da conta.</li>
<li>Confirma se o cartão de crédito usado não expirou.</li>
</ul>
</li>
<li><strong>Atualizar Saldos:</strong>
<ul>
<li>Se a transação for válida, o programa atualiza:
<ul>
<li>Saldo da Categoria de Transação: Isso rastreia os totais para vários tipos de transação (por exemplo, compras, pagamentos).</li>
<li>Saldo da Conta: O saldo da conta do cliente é ajustado, aumentando para pagamentos e diminuindo para compras.</li>
</ul>
</li>
</ul>
</li>
<li><strong>Registrar Transação:</strong>
<ul>
<li>A transação validada, juntamente com um registro de data e hora, é registrada no Arquivo de Transações.</li>
</ul>
</li>
<li><strong>Lidar com Rejeições:</strong>
<ul>
<li>Se uma transação falhar na validação, ela é marcada com um motivo de rejeição e gravada no Arquivo de Rejeições Diárias para investigação posterior e possível acompanhamento.</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><strong>Encerramento (Fechar Arquivos):</strong> Assim que todas as transações forem processadas, o programa fecha todos os arquivos abertos.</li>
</ol>
<h2>Requisitos para Iniciar o Processo</h2>
<ul>
<li>Acesso aos seguintes arquivos com as permissões adequadas:
<ul>
<li>Arquivo de Transações Diárias (entrada)</li>
<li>Arquivo de Transações (saída)</li>
<li>Arquivo de Referência Cruzada (entrada)</li>
<li>Arquivo de Rejeições Diárias (saída)</li>
<li>Arquivo de Conta (entrada/saída)</li>
<li>Arquivo de Saldo de Categoria de Transação (entrada/saída)</li>
</ul>
</li>
</ul>
<h2>Validações e Regras</h2>
<ul>
<li><strong>Limite de Crédito:</strong> O sistema impede transações que fariam com que uma conta excedesse seu limite de crédito.</li>
<li><strong>Expiração do Cartão:</strong> As transações são rejeitadas se o cartão de crédito usado estiver com a data de expiração vencida.</li>
<li><strong>Categorização de Transações:</strong> As transações são categorizadas para permitir que a empresa rastreie diferentes tipos de atividades.</li>
<li><strong>Tratamento de Rejeição:</strong> As transações inválidas são registradas com os motivos, fornecendo uma trilha de auditoria.</li>
</ul>
<h2>Detalhes técnicos</h2>
<h3>Variáveis:</h3>
<ul>
<li><code>DALYTRAN-RECORD</code>: Contém a transação atual sendo processada do Arquivo de Transações Diárias.</li>
<li><code>TRAN-RECORD</code>: Armazena os detalhes da transação que está sendo processada para saída para o Arquivo de Transações.</li>
<li><code>CARD-XREF-RECORD</code>: Contém as informações de referência cruzada lidas do Arquivo de Referência Cruzada.</li>
<li><code>ACCOUNT-RECORD</code>: Contém as informações da conta lidas do Arquivo de Conta.</li>
<li><code>TRAN-CAT-BAL-RECORD</code>: Armazena as informações de saldo da categoria de transação.</li>
<li><code>WS-VALIDATION-FAIL-REASON</code>: Contém um código indicando o motivo da falha na validação da transação.</li>
<li><code>WS-VALIDATION-FAIL-REASON-DESC</code>: Contém uma descrição textual do motivo da falha na validação da transação.</li>
<li><code>WS-TRANSACTION-COUNT</code>: Rastreia o número total de transações processadas.</li>
<li><code>WS-REJECT-COUNT</code>: Rastreia o número total de transações rejeitadas.</li>
</ul>
<h3>Métodos:</h3>
<ul>
<li><code>0000-DALYTRAN-OPEN</code>: Abre o Arquivo de Transações Diárias.</li>
<li><code>0100-TRANFILE-OPEN</code>: Abre o Arquivo de Transações.</li>
<li><code>0200-XREFFILE-OPEN</code>: Abre o Arquivo de Referência Cruzada.</li>
<li><code>0300-DALYREJS-OPEN</code>: Abre o Arquivo de Rejeições Diárias.</li>
<li><code>0400-ACCTFILE-OPEN</code>: Abre o Arquivo de Conta.</li>
<li><code>0500-TCATBALF-OPEN</code>: Abre o Arquivo de Saldo de Categoria de Transação.</li>
<li><code>1000-DALYTRAN-GET-NEXT</code>: Lê a próxima transação do Arquivo de Transações Diárias.</li>
<li><code>1500-VALIDATE-TRAN</code>: Orquestra o processo de validação da transação.
<ul>
<li><code>1500-A-LOOKUP-XREF</code>: Pesquisa o número do cartão de crédito no Arquivo de Referência Cruzada.</li>
<li><code>1500-B-LOOKUP-ACCT</code>: Recupera informações da conta, verifica se há excesso de limite e a expiração do cartão.</li>
</ul>
</li>
<li><code>2000-POST-TRANSACTION</code>: Processa uma transação válida, incluindo a atualização de saldos e a gravação de registros.</li>
<li><code>2500-WRITE-REJECT-REC</code>: Grava uma transação rejeitada no Arquivo de Rejeições Diárias.</li>
<li><code>2700-UPDATE-TCATBAL</code>: Atualiza o Arquivo de Saldo de Categoria de Transação.
<ul>
<li><code>2700-A-CREATE-TCATBAL-REC</code>: Cria um novo registro no Arquivo de Saldo de Categoria de Transação se ele não existir.</li>
<li><code>2700-B-UPDATE-TCATBAL-REC</code>: Atualiza um registro existente no Arquivo de Saldo de Categoria de Transação.</li>
</ul>
</li>
<li><code>2800-UPDATE-ACCOUNT-REC</code>: Atualiza o Arquivo de Conta com os detalhes da transação.</li>
<li><code>2900-WRITE-TRANSACTION-FILE</code>: Grava a transação processada no Arquivo de Transações.</li>
<li><code>9000-DALYTRAN-CLOSE</code>: Fecha o Arquivo de Transações Diárias.</li>
<li><code>9100-TRANFILE-CLOSE</code>: Fecha o Arquivo de Transações.</li>
<li><code>9200-XREFFILE-CLOSE</code>: Fecha o Arquivo de Referência Cruzada.</li>
<li><code>9300-DALYREJS-CLOSE</code>: Fecha o Arquivo de Rejeições Diárias.</li>
<li><code>9400-ACCTFILE-CLOSE</code>: Fecha o Arquivo de Conta.</li>
<li><code>9500-TCATBALF-CLOSE</code>: Fecha o Arquivo de Saldo de Categoria de Transação.</li>
</ul>
<h2>Impacto em Outros Sistemas</h2>
<ul>
<li>Este programa interage diretamente com vários outros componentes do aplicativo CardDemo:
<ul>
<li>Ele recebe entrada do Arquivo de Transações Diárias, que provavelmente é gerado por outro sistema ou processo.</li>
<li>Ele atualiza o Arquivo de Transações, o Arquivo de Conta e o Arquivo de Saldo de Categoria de Transação, que são usados por outros componentes para várias funcionalidades, como relatórios, gerenciamento de contas, etc.</li>
<li>O Arquivo de Rejeições Diárias gerado por este programa serve como uma trilha de auditoria e é provavelmente monitorado por um processo ou equipe separado.</li>
</ul>
</li>
</ul>
<h2>Modelos</h2>
<table>
<thead>
<tr>
<th>Campo de Nome</th>
<th>Tipo</th>
<th>Descrição</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>DALYTRAN-ID</code></td>
<td>String</td>
<td>Identificador exclusivo para cada transação diária.</td>
</tr>
<tr>
<td><code>DALYTRAN-TYPE-CD</code></td>
<td>String</td>
<td>Código que indica o tipo de transação (por exemplo, compra, pagamento).</td>
</tr>
<tr>
<td><code>DALYTRAN-CAT-CD</code></td>
<td>String</td>
<td>Código que categoriza a transação (por exemplo, mantimentos, combustível, entretenimento).</td>
</tr>
<tr>
<td><code>DALYTRAN-SOURCE</code></td>
<td>String</td>
<td>Origem da transação (por exemplo, online, terminal POS).</td>
</tr>
<tr>
<td><code>DALYTRAN-DESC</code></td>
<td>String</td>
<td>Descrição da transação.</td>
</tr>
<tr>
<td><code>DALYTRAN-AMT</code></td>
<td>Decimal</td>
<td>Valor da transação.</td>
</tr>
<tr>
<td><code>DALYTRAN-MERCHANT-ID</code></td>
<td>String</td>
<td>Identificador exclusivo para o comerciante envolvido na transação.</td>
</tr>
<tr>
<td><code>DALYTRAN-MERCHANT-NAME</code></td>
<td>String</td>
<td>Nome do comerciante.</td>
</tr>
<tr>
<td><code>DALYTRAN-MERCHANT-CITY</code></td>
<td>String</td>
<td>Cidade do comerciante.</td>
</tr>
<tr>
<td><code>DALYTRAN-MERCHANT-ZIP</code></td>
<td>String</td>
<td>CEP do comerciante.</td>
</tr>
<tr>
<td><code>DALYTRAN-CARD-NUM</code></td>
<td>String</td>
<td>Número do cartão de crédito usado para a transação.</td>
</tr>
<tr>
<td><code>DALYTRAN-ORIG-TS</code></td>
<td>String</td>
<td>Registro de data e hora indicando quando a transação foi iniciada.</td>
</tr>
<tr>
<td><code>TRAN-PROC-TS</code></td>
<td>String</td>
<td>Registro de data e hora indicando quando a transação foi processada.</td>
</tr>
<tr>
<td><code>XREF-ACCT-ID</code></td>
<td>String</td>
<td>ID da conta associada ao número do cartão de crédito.</td>
</tr>
<tr>
<td><code>ACCT-CURR-BAL</code></td>
<td>Decimal</td>
<td>Saldo atual da conta.</td>
</tr>
<tr>
<td><code>ACCT-CURR-CYC-CREDIT</code></td>
<td>Decimal</td>
<td>Total de créditos no ciclo atual.</td>
</tr>
<tr>
<td><code>ACCT-CURR-CYC-DEBIT</code></td>
<td>Decimal</td>
<td>Total de débitos no ciclo atual.</td>
</tr>
<tr>
<td><code>ACCT-CREDIT-LIMIT</code></td>
<td>Decimal</td>
<td>Limite de crédito da conta.</td>
</tr>
<tr>
<td><code>ACCT-EXPIRATION-DATE</code></td>
<td>String</td>
<td>Data de expiração do cartão de crédito.</td>
</tr>
<tr>
<td><code>TRAN-CAT-BAL</code></td>
<td>Decimal</td>
<td>Saldo para uma categoria de transação específica.</td>
</tr>
<tr>
<td><code>FD-TRAN-CAT-KEY</code></td>
<td>String</td>
<td>Chave composta para o registro de saldo da categoria de transação (inclui ID da conta, código do tipo de transação e código da categoria).</td>
</tr>
</tbody>
</table>
<h2>Referências Principais</h2>
<ul>
<li>Arquivo de Transações Diárias: Fornece a entrada para o programa.</li>
<li>Arquivo de Transações: Armazena as transações processadas com sucesso.</li>
<li>Arquivo de Referência Cruzada: Usado para validar números de cartão de crédito e recuperar IDs de conta.</li>
<li>Arquivo de Rejeições Diárias: Contém transações rejeitadas e os motivos da rejeição.</li>
<li>Arquivo de Conta: Fornece e atualiza as informações da conta do cliente.</li>
<li>Arquivo de Saldo de Categoria de Transação: Rastreia saldos para diferentes categorias de transação.</li>
</ul>
<p>–Made by “Smart Engineering” (by Compass.UOL)–</p>

    </div>
    <!-- Incluindo o jQuery e o Bootstrap JS a partir de CDN -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.2/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Incluindo o Highlight.js JS para destaque de código -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
    <script>hljs.highlightAll();</script>
</body>
</html>
