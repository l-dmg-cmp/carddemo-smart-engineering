sequenceDiagram
    participant Program
    participant TransactionFile
    participant ReportFile

    activate Program
    Program->>+TransactionFile: Open
    TransactionFile-->>-Program: Open Successful
    
    loop For Each Record in Transaction File
        Program->>+TransactionFile: Read Record
        TransactionFile-->>-Program: Transaction Data
        
        Program->>Program: Validate Record
        alt Record Valid
            Program->>Program: Calculate Balance
            Program->>+ReportFile: Write Record
            ReportFile-->>-Program: Write Successful
        else Record Invalid
            Program->>Program: Log Error
        end
    end
    
    Program->>+ReportFile: Close
    ReportFile->>-Program: Close Successful
    Program->>+TransactionFile: Close
    TransactionFile->>-Program: Close Successful
    deactivate Program